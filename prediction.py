# -*- coding: utf-8 -*-
"""Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1rZUeZKi9oKdyDdqSiuQPpwK5bHtNaJUU
"""

import numpy as np
import cv2
from PIL import Image
import tensorflow as tf

INPUT_SIZE = 244

def preprocess_single_image(image_path):
    image = cv2.imread(image_path)
    image = Image.fromarray(image, 'RGB')
    image = image.resize((INPUT_SIZE, INPUT_SIZE))
    image = np.array(image) / 255.0
    return np.expand_dims(image, axis=0)

model = tf.keras.models.load_model('heart_attack_prediction_model.h5')

image_path = r"D:\Project\Predicting_Cardiovascular_Risk\dataset\Moderate\0efc93ec838b.png"

image = preprocess_single_image(image_path)

batch_size = 32  # Adjust this value as needed based on your system's resources
predictions = model.predict(test_images, batch_size=batch_size)

predicted_class = np.argmax(prediction)
if predicted_class == 0:
    risk_level = "No DR"
elif predicted_class == 1:
    risk_level = "Mild"
elif predicted_class == 2:
    risk_level = "Moderate"
elif predicted_class == 3:
    risk_level = "Severe"
else:
    risk_level = "Proliferative DR"

print("Predicted risk level of heart attack:", risk_level)

import os

if os.path.exists('heart_attack_prediction_model.h5'):
    print("Model file exists!")
else:
    print("Model file does not exist.")